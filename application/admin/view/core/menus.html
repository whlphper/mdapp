{include file="admin@public/header"}
<link href="__PUBLIC__/vendors/bootgrid/jquery.bootgrid.min.css" rel="stylesheet">
<body>
{include file="admin@public/nav"}
<section id="main" data-layout="layout-1">
    {include file="admin@public/menu"}
    <!--主体内容-->
    <section id="content">
        <div class="container">
            <div class="block-header">
                <h2>菜单列表</h2>
                <!--右侧按钮-->
                <ul class="actions">
                    <li>
                        <a href="">
                            <i class="zmdi zmdi-trending-up"></i>
                        </a>
                    </li>
                    <li>
                        <a href="">
                            <i class="zmdi zmdi-check-all"></i>
                        </a>
                    </li>
                    <li class="dropdown">
                        <a href="" data-toggle="dropdown">
                            <i class="zmdi zmdi-more-vert"></i>
                        </a>

                        <ul class="dropdown-menu dropdown-menu-right">
                            <li>
                                <a href="">Refresh</a>
                            </li>
                            <li>
                                <a href="">Manage Widgets</a>
                            </li>
                            <li>
                                <a href="">Widgets Settings</a>
                            </li>
                        </ul>
                    </li>
                </ul>
            </div>
            <div class="card">
                <div class="card-header">
                    <h2>菜单列表

                    </h2>
                </div>
                <div id="toolbar">
                    <div class="row">
                        <div class="col-sm-12 ">
                            <div class="col-sm-3">
                                <div class="input-group">
                                    <a href="{:url('admin/Core/storeMenu')}"><button class="btn btn-info waves-effect"><i class="zmdi zmdi-plus">&nbsp;&nbsp;</i>新增</button>&nbsp;&nbsp;</a>
                                    <button class="btn btn-warning waves-effect"><i class="zmdi zmdi-delete">&nbsp;&nbsp;</i>批量删除</button>
                                </div>
                            </div>
                        </div>
                        <br />
                        <div class="col-sm-12" style="margin-top: 1%;">
                            <form id="sysMenusSearch">
                                <div class="col-sm-3">
                                    <div class="input-group">
                                        <span class="input-group-addon"><i class="zmdi zmdi-collection-text">菜单名称</i></span>
                                        <div class="fg-line">
                                            <input type="text" class="form-control" name="name" placeholder="请输入菜单名称">
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-3 pull-right">
                                    <div class="input-group">
                                        <a class="btn btn-info waves-effect bootstrap-search" refreshTableID="sysMenuTable"><i class="zmdi zmdi-search">&nbsp;</i>搜索</a>&nbsp;
                                        <a class="btn bgm-teal waves-effect bootstrap-reset" refreshTableID="sysMenuTable"><i class="zmdi zmdi-refresh">&nbsp;</i>重置</a>&nbsp;
                                        <a class="btn bgm-amber waves-effect"><i class="zmdi zmdi-check-all">&nbsp;</i>导出</a>&nbsp;
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
                <table id="sysMenuTable" class="table table-vmiddle" data-side-pagination="server"
                       data-url="{:url('/admin/Core/getMenus')}" data-toggle="table" data-toolbar="#toolbar"
                       data-pagination="true" data-page-list="[5, 10, 20, 50, 100, 200]">
                    <thead>
                    <tr>
                        <th data-checkbox="true"></th>
                        <th data-field="name" data-formatter="">菜单名称</th>
                        <th data-field="url">菜单地址</th>
                        <th data-field="sort">排序</th>
                        <th data-field="flag" data-sortable="true">图标</th>
                        <th data-field="action" data-formatter="actionFormatter" data-events="actionEvents"></th>
                    </tr>
                    </thead>
                </table>
            </div>
        </div>
    </section>
</section>
{include file="admin@public/footer"}
<!-- Javascript Libraries -->
<script src="__PUBLIC__/vendors/bower_components/malihu-custom-scrollbar-plugin/jquery.mCustomScrollbar.concat.min.js"></script>
<script src="__PUBLIC__/vendors/bower_components/Waves/dist/waves.min.js"></script>
<script src="__PUBLIC__/vendors/bootstrap-growl/bootstrap-growl.min.js"></script>
<script src="__PUBLIC__/vendors/bower_components/bootstrap-sweetalert/lib/sweet-alert.min.js"></script>
<script src="__PUBLIC__/vendors/bootgrid/jquery.bootgrid.updated.min.js"></script>


<script src="__PUBLIC__/vendors/bootstraptable/bootstrap-table.js"></script>
<script src="__PUBLIC__/vendors/bootstraptable/locale/bootstrap-table-zh-CN.js"></script>
<link rel="stylesheet" href="__PUBLIC__/vendors/bootstraptable/bootstrap-table.css">
{include file="admin@public/search"}
<script type="text/javascript">
    $(document).ready(function () {

    });
    //每行操作渲染
    function actionFormatter() {

        return '<button class="btn btn-default btn-icon-text waves-effect edit"><i class="zmdi zmdi-edit"></i>编辑</button>&nbsp;&nbsp;<button class="btn btn-default btn-icon-text waves-effect delete"><i class="zmdi zmdi-delete"></i>删除</button>';
    }
    //每行操作对应事件
    window.actionEvents = {
        'click .delete': function (e, value, row, index) {
            var url = "{:url('/admin/Core/deleteMenu/id/" + row.id + "')}";
            swal({
                title: "确定删除此菜单吗",
                text: "删除后不可恢复,请谨慎操作!",
                type: "warning",
                showCancelButton: true,
                confirmButtonColor: "#DD6B55",
                confirmButtonText: "确定!",
                closeOnConfirm: false
            }, function(){
                mdAjax($(this),url,{},function(res){
                    swal('提示', res["msg"], "success");
                    $("#sysMenuTable").bootstrapTable('refresh');
                    setTimeout(function(){
                        $(".confirm").click();
                    },500);
                },'GET')
            });
        },
        'click .edit': function (e, value, row, index) {
            var url = "{:url('/admin/Core/storeMenu/id/" + row.id + "')}";
            location.href = url;
        },
    };
</script>
</body>
</html>